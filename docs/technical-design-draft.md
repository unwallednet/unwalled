# **Unwalled: Technical Design Document for a Decentralized, High-Frequency Advertising Exchange**

## **Executive Summary**

The digital advertising industry is facing a crisis of confidence, characterized by opaque supply chains, rampant fraud, and a misaligned value exchange that treats users as products rather than partners. The dominant "walled garden" ecosystems, while profitable for their operators, stifle innovation, extract exorbitant fees, and operate with a lack of transparency that erodes trust among advertisers, publishers, and users alike. The Unwalled project is conceived as a direct response to this systemic failure. Its vision is to create a decentralized, permissionless, and radically transparent ad-tech ecosystem built on new, open standards capable of supporting high-frequency, low-cost advertising transactions.  
This technical design document defines the comprehensive technology architecture to realize that vision. The proposed system is not an incremental improvement upon existing ad-tech but a fundamental re-imagining of its core mechanics. The architecture adapts a vertically integrated, application-specific blockchain model proven effective in decentralized finance. By applying these rigorous engineering principles, Unwalled can dismantle the proprietary walls that define the current landscape and build a foundational network for a fairer, more efficient, and verifiable open internet.  
The core of the Unwalled architecture is a purpose-built Layer-1 application chain, or "app-chain," where the ad exchange is not an application *on* the blockchain but a native feature *of* the blockchain itself. This vertical integration allows for deep, protocol-level optimizations impossible on general-purpose networks. The central primitive of this chain is the "Unwalled Ad Book" (UAB), an in-consensus Central Limit Order Book (CLOB) that matches advertiser bids and publisher asks with deterministic, price-time priority. This replaces opaque, proprietary auctions with a transparent, auditable, and fair marketplace for what we define as the core asset: the "Verifiable Attention Impression" (VAI).  
This system is built upon a foundation of Decentralized Identity (DID), ensuring every participant is cryptographically verifiable, thus creating a "truth layer" that serves as a critical hedge against an internet increasingly populated by AI bots. The architecture defines a hybrid model for scalability, processing millions of micro-bids per second on the dedicated app-chain while leveraging a standardized interface to connect to high-performance base layers for final settlement of campaign funds. This pragmatic design makes a deliberate and sophisticated trade-off, optimizing for application-specific performance and decentralization where it matters most—in the matching engine—while utilizing a hyper-scalable, compliance-focused rail for high-value settlement.  
This document serves as the foundational technical blueprint for the Unwalled development team. It deconstructs the engineering philosophy, details the protocol stack, defines the data structures and transaction flows, and outlines a clear implementation and scalability roadmap. The result is an architecture designed to create a new internet-native economic primitive that realigns incentives, compensates users for their attention, and provides a transparent, high-performance alternative to the incumbent ad-tech oligopoly.

## **Section 1: Foundational Principles for Internet-Scale Decentralized Systems**

The successful construction of the Unwalled network requires adherence to a set of core engineering principles derived from the successes and failures of existing high-performance distributed systems. The challenges inherent in creating a fair, transparent, and low-latency real-time bidding (RTB) system are deeply analogous to those faced by on-chain HFT exchanges. Both domains are characterized by a massive volume of small, time-sensitive transactions, a high degree of state contention on a central matching facility, and an absolute requirement for deterministic, fair, and auditable execution. Therefore, the architectural patterns pioneered by high-performance on-chain exchanges are not merely an inspiration but a direct and applicable blueprint.

### **1.1 The Application-Specific Imperative: Vertical Integration Over Horizontal Generality**

The foundational architectural decision for Unwalled is to reject the general-purpose Layer-1 blockchain model in favor of a purpose-built, application-specific L1. The Unwalled vision, which requires handling millions of transactions per second with near-instant finality and extremely low costs, cannot be realized as a smart contract application on a shared, general-purpose network.  
The experience of on-chain CLOBs on high-performance general-purpose platforms serves as a critical cautionary tale. The core issue is not technical but economic. In a general-purpose environment, all applications—from DeFi and gaming to NFT mints—compete for the same finite block space in a single, unified fee market. During periods of high demand from any one application, network-wide priority fees skyrocket. For an ad exchange, where market makers (advertisers) must constantly update thousands of bids per second, each with a fractional-cent value, this economic model is untenable. The cost of landing the necessary state updates on-chain becomes prohibitively expensive, rendering the core economic activity of the exchange unviable.  
By building a bespoke L1 from the ground up, the protocol developers gain absolute control over the entire technology stack—consensus, state execution, networking, and the fee market itself. This allows for deep, protocol-level optimizations tailored specifically for a single, demanding use case. The exchange ceases to be a guest application competing for resources and becomes a native feature of the blockchain.  
For Unwalled, this model is not just advantageous; it is a prerequisite for success. An application-specific chain creates a localized, insulated economic environment. The fee market can be engineered to specifically support the high-volume, low-value nature of ad bidding, ensuring that the system's core operations are never priced out by unrelated on-chain activity. This choice is therefore a fundamental economic one, guaranteeing the long-term viability of the Unwalled marketplace.

### **1.2 In-Consensus State Machines: The Path to Determinism and Trustlessness**

The second foundational principle is the embedding of core application logic directly into the protocol's state transition function, rather than deploying it within a virtual machine as a set of smart contracts. This "in-consensus" architecture is the key to achieving maximum performance, determinism, and trustlessness.  
An in-consensus CLOB provides the template. Its order book is not a smart contract but a native data structure managed directly by the validator nodes as part of the core protocol. The matching engine logic is an integral part of the state transition function that every validator executes when processing a block. This design confers several critical advantages. First, it eliminates the significant overhead and performance limitations of a virtual machine, allowing for execution speeds comparable to traditional, non-blockchain systems. Second, it enables atomic settlement; trades are matched and settled in the same indivisible state transition, eradicating counterparty and settlement risk. Third, it enhances security and transparency. The matching algorithm is not a proprietary, black-box process but part of the open-source node software, making it fully auditable by any third party.  
This architectural pattern directly fulfills Unwalled's mandate for a "radically transparent" and "cryptographically verifiable supply chain". By implementing the ad-matching engine as an in-consensus state machine, Unwalled ensures there can be no hidden, preferential treatment of certain advertisers or publishers. The rules of the marketplace are encoded in the protocol itself, and every match is a deterministic outcome of those rules, verifiable by replaying the on-chain history of transactions. This provides the absolute certainty and settlement assurance required to build a trusted, neutral market infrastructure.

### **1.3 Semantic Awareness: Protocol-Level Guarantees for Application-Level Fairness**

Perhaps the most subtle and powerful principle to be adapted from high-performance on-chain systems is the concept of a "semantically aware" protocol. This refers to a system where the consensus layer is not agnostic to the transactions it processes but understands their application-level meaning and intent. Based on this understanding, the protocol can enforce a strict, deterministic sorting order for actions within every block.  
In a trading environment, for example, a protocol can differentiate between actions that interact with the order book and those that do not, and critically, between cancel\_order and place\_order transactions. It can mandate that within any given block, cancellations are *always* processed before new orders. This provides a powerful execution guarantee, eliminating a common race condition where a trader's cancellation request might be processed after their order is filled against their wishes.  
This principle is directly applicable and immensely valuable in the ad-tech domain. The Unwalled protocol is designed to understand the semantics of place\_bid, cancel\_bid, and trigger\_auction. By enforcing a deterministic intra-block sorting order (e.g., cancellations first, then new bids, then auction triggers), the protocol can eliminate entire classes of execution risk and front-running that plague current RTB systems. For example, an advertiser could be cryptographically certain that their bid cancellation, if included in the same block as an ad auction it was intended for, will always be processed first, preventing an unwanted ad spend. This protocol-level guarantee of fairness is a profound advantage that can only be implemented on an application-specific blockchain where the protocol is deeply aware of the application's logic.

### **1.4 The Partitioning Principle: Isolating Performance and Managing Data Entropy**

Finally, the architecture adopts a pragmatic approach to partitioning system components to isolate performance-critical logic and manage the immense data footprint of an internet-scale system. Two key strategies are essential.  
First is **Execution Partitioning**. A dual-engine architecture resolves the conflict between performance and flexibility. It isolates the mission-critical matching engine from the unpredictable computational load of arbitrary smart contracts, ensuring that, for example, a popular third-party analytics dApp cannot degrade the performance of the core ad exchange. Unwalled adopts this model to separate its core "AdMatch" engine from a general-purpose environment where developers can build custom attribution models, advanced analytics tools, or novel campaign financing mechanisms.  
Second is **Data Partitioning**. A high-throughput system like Unwalled will generate terabytes of data daily. Storing this entire history on-chain and requiring every validator to maintain it is impractical and would eventually grind the network to a halt. A hybrid data persistence strategy offers a sensible solution: the live, canonical state of the order book is secured by the decentralized validator network, while the full historical dataset (trades, order statuses, raw book diffs) is periodically archived to a public cloud store like AWS S3 or a decentralized storage network. This approach combines the decentralized security of the on-chain ledger for real-time operations with the cost-effectiveness and accessibility of centralized cloud storage for non-real-time historical analysis, auditing, and application development. It allows the core protocol to remain lean and performant while upholding the principle of data transparency.

## **Section 2: The Unwalled Paradigm: An Asymmetric Order Book for Digital Attention**

Applying the foundational principles from the preceding section, it is possible to construct a new paradigm for digital advertising. This section serves as the conceptual bridge, mapping the architecture of a high-frequency trading exchange to the specific problem domain of ad-tech. It re-imagines the core components of the advertising ecosystem as primitives within an open, transparent, and protocol-driven economy.

### **2.1 Deconstructing the "Walled Garden": From Opaque Auctions to an Open Marketplace**

The name "Unwalled" is not merely a brand; it is a technical and philosophical mandate. The current ad-tech landscape is defined by a series of opaque, proprietary "walled gardens" where the rules of engagement are set by a central operator for their own benefit. Unwalled's primary objective is to dismantle these structures.  
This vision resonates with the ethos of earlier projects that sought to create open, peer-to-peer alternatives to centralized platforms. The "Unwalled. Garden" project, for instance, proposed a "souped-up RSS for P2P social apps" built on simple, open, file-oriented protocols. Its core principles—"Every user is a website," "Every record is a file," and "Users follow each other's sites to sync their files"—champion user sovereignty and data portability. Unwalled's architecture embodies this same spirit, shifting the industry from closed, API-driven systems to open, protocol-driven systems. The state of the market is not hidden behind a corporate API but is directly accessible and verifiable on a public ledger.  
Furthermore, the name evokes the biblical concept of a "land of unwalled villages," described as a place of tranquility and security, where people dwell safely without the need for defensive fortifications. This metaphor frames Unwalled's deeper goal: to create a more secure and less adversarial digital environment. By replacing surveillance-based targeting with a consent-driven model and opaque auctions with a transparent order book, the system aims to foster a relationship between users, publishers, and advertisers built on intrinsic trust and verifiable fairness, rather than on adversarial checks and balances.

### **2.2 Reconciling the CLOB for Ad-Tech: An Asymmetric Model**

A direct application of a financial Central Limit Order Book (CLOB) is not suitable for ad-tech due to a fundamental asymmetry between the buy and sell sides. In financial markets, both buy (bid) and sell (ask) orders can be persistent, resting on the book for long periods. In advertising, this is not the case.  
The **buy-side** (advertisers) is indeed persistent. An advertiser can place a standing bid to show an ad to a user with very specific attributes (e.g., "one of the 10 users who visited my Shopify store") and leave that bid open indefinitely, waiting for one of those users to appear anywhere on the network.  
The **sell-side** (publisher inventory), however, is completely dynamic and ephemeral. An ad slot for a specific user on a specific website exists only for the few hundred milliseconds it takes to make an ad decision. There is no "resting" sell order for this unique impression.  
Therefore, the Unwalled Ad Book (UAB) is an **asymmetric CLOB**, designed specifically for this reality. It features a deep, persistent buy-side order book of standing bids, which are matched in real-time against a stream of ephemeral, dynamically generated sell-side auction triggers. This model enables the programmatic, democratic vision of Unwalled, where a small business can place highly specific, high-value bids that are automatically activated the instant a target user appears, outbidding any other advertiser for that unique moment of attention.

### **2.3 Defining the Primitives: Re-imagining Ad-Tech for a Protocol Economy**

To build this new economy, the familiar concepts of ad-tech are formally redefined as primitives of this asymmetric exchange.

* **The Tradable Asset: The Verifiable Attention Impression (VAI)** The fundamental unit of trade in the Unwalled ecosystem is not a simple "impression." It is a VAI—a cryptographically verifiable event that immutably links a DID-authenticated user, a specific publisher-owned ad slot, a specific advertiser campaign, and a precise timestamp. This transforms the ephemeral concept of an "impression" into a discrete, auditable, and settleable on-chain asset.  
* **The "Auction Trigger" (The Sell-Side)** When a user loads a page, the publisher does not place a persistent "Ask" order. Instead, their client-side software generates a real-time **Auction Trigger**. This is an on-chain transaction declaring that a unique, time-sensitive ad opportunity is available *right now*. This trigger contains the targeting attributes of the user (derived from their DID and Verifiable Credentials) and the publisher's minimum acceptable price (floor price).  
* **The "Bid" Order (The Buy-Side)** An advertiser places a persistent "Bid" order on the UAB. This order is a declaration of demand for a *type* of user, not for a specific ad slot. It specifies the targeting criteria they are seeking and the maximum price they are willing to pay for a VAI that matches those criteria. These bids rest on the order book, waiting to be matched against an incoming Auction Trigger.

This new model represents a profound departure from the mechanics of existing standards like OpenRTB. The following table provides a direct translation of concepts from the traditional ad-tech world to the Unwalled paradigm, highlighting the specific innovations at each step.  
**Table 2.1: Paradigm Shift: From OpenRTB to the Unwalled Ad Book (UAB)**

| Feature | Traditional Ad-Tech (e.g., OpenRTB) | The Unwalled Paradigm |
| :---- | :---- | :---- |
| **Auction Model** | Opaque, complex (often second-price), run by intermediaries (SSPs/DSPs). | Transparent, on-chain Asymmetric CLOB with strict Price-Time Priority. |
| **Core Asset** | An "impression" or "click" (often unverifiable and prone to fraud). | A "Verifiable Attention Impression" (VAI), cryptographically signed and co-attested. |
| **Identity** | Cookie-based, probabilistic, controlled by platforms, privacy-invasive. | DID-based, user-controlled, pseudo-anonymous, and consent-driven. |
| **Bidding** | Bid requests are broadcast to multiple bidders; auctions are held off-chain in black boxes. | Persistent bids for user attributes rest on a public, on-chain order book. |
| **Selling** | Publishers list inventory with SSPs. | Publishers generate real-time, ephemeral "Auction Triggers" for each impression. |
| **Matching** | Proprietary, often self-serving algorithms within centralized ad exchanges. | Deterministic, open-source, in-consensus matching engine executes against the buy-side book. |
| **Settlement** | Slow, complex, batched payments (Net 30/60/90) with high intermediary fees. | Atomic, real-time settlement of every impression; direct wallet-to-wallet payments. |
| **User Role** | Product; data is harvested without consent or direct compensation. | First-class economic participant; compensated directly for attention and consented data. |

### **2.4 Decentralized Identity (DID) as the System's Sybil-Resistant Foundation**

The entire Unwalled architecture is predicated on a robust, cryptographically secure identity layer. Decentralized Identity (DID) is not an add-on but the foundational primitive that enables a "cryptographically verifiable supply chain" and provides Sybil resistance.  
Every participant in the ecosystem—user, advertiser, and publisher—possesses a DID, managed through a user-controlled digital wallet. This DID serves multiple critical functions: it is their passport to the network, their payment address for sending and receiving funds, and the anchor for their on-chain reputation. When an advertiser pays for a VAI, they can be cryptographically certain that the funds are being sent to the specific publisher who served the ad and that a share of those funds is being rebated to the specific (pseudo-anonymous) user who viewed it. The entire chain of events is auditable on-chain, from campaign funding to final impression settlement.  
This DID-based foundation is the system's primary defense against the pervasive problem of bot fraud. The Unwalled vision explicitly requires identity verification to prevent botnets from creating fraudulent identities to illegitimately claim user rewards. To balance privacy and security, the system supports a tiered identity model. For instance:

* **Tier 1 (Anonymous):** A basic did:key allows for participation but may have lower reputation or be ineligible for certain high-value campaigns.  
* **Tier 2 (Verified Attributes):** Users can attach Verifiable Credentials (VCs) to their DID from trusted third-party issuers (e.g., a VC verifying they are over 18 or reside in a specific country) without revealing their legal identity.  
* **Tier 3 (Fully Verified):** For advertisers, publishers, and users seeking maximum rewards, an optional KYC process (potentially anchored by on-chain identity solutions) can link the DID to a real-world entity, providing the highest level of trust and Sybil resistance.

This structure ensures that engagement is verifiably human, a crucial guarantee in an era of increasingly sophisticated AI bots, and directly enables the "toll" model where non-verified or suspected bot traffic is charged for access rather than rewarded.

## **Section 3: System Architecture: The Unwalled Protocol Stack**

This section presents the technical core of the report: a detailed architectural blueprint for the Unwalled Layer-1 application chain. The design explicitly models the successful, performance-oriented patterns of on-chain exchanges, adapting them to the specific requirements of a decentralized, high-frequency ad-tech marketplace.

### **3.1 The Unwalled L1: A Vertically Integrated Ad-Tech Chain**

The Unwalled L1 is an application-specific blockchain built from first principles. The node software is a monolithic, self-contained binary, developed in a high-performance, memory-safe language. This provides low-level control while preventing common classes of security vulnerabilities.  
The core components of the Unwalled L1 are designed for maximum performance and determinism:

* **Core Logic:** The central feature is the in-consensus "Unwalled Ad Book" (UAB), an asymmetric CLOB designed for matching persistent bids against ephemeral auction triggers.  
* **Consensus:** The network is secured by a BFT consensus protocol built using the HotStuff-rs implementation. This type of consensus is engineered for continuous transaction sequencing, making it ideal for the high frequency of bid creations, cancellations, and auction triggers in an ad exchange. It targets sub-second finality, which is critical for real-time feedback.  
* **State Machine:** Core logic—including the UAB, DID registry, campaign treasuries, and attribution logic—is implemented as native Rust modules. This approach avoids the overhead of a virtual machine, maximizing performance for the critical matching path.  
* **Transaction Types:** The protocol defines domain-specific actions like place\_bid, cancel\_bid, trigger\_auction, fund\_campaign, and claim\_reward.  
* **Intra-Block Sorting:** The protocol enforces a deterministic sorting order within each block (e.g., 1\. DID/Campaign actions, 2\. Cancellations, 3\. New Bids, 4\. Auction Triggers) to provide execution guarantees and prevent front-running.  
* **Execution Partitioning:** The system features a dual-engine design: the "AdMatch Engine" for the permissioned, high-performance matching logic, and a "U-EVM" as a permissionless environment for third-party developers to build tools like analytics or attribution models without risking core network performance.  
* **Data Persistence:** A hybrid model is used, keeping the live UAB state on-chain while archiving historical data to a decentralized network (e.g., Arweave) or public cloud for analysis and auditing.

### **3.2 "AdMatch": The In-Consensus Ad Matching Engine**

The heart of the Unwalled L1 is the AdMatch engine, the in-consensus module responsible for maintaining the UAB and matching bids with auction triggers.

#### **3.2.1 State Representation**

To ensure deterministic and high-performance execution, the on-chain data structures for the UAB are meticulously designed. The system avoids floating-point arithmetic, which is computationally expensive and can introduce non-determinism.

* **Pricing:** All prices (bids, floor prices) are represented as integer multiples of a base unit, the smallest indivisible unit of currency in the system (e.g., 10^{-6} $KUSD). This is analogous to a "tick size" in a traditional exchange.  
* **Targeting Attributes:** Targeting criteria (e.g., interest=sports, geo=us, device=mobile) are not stored as strings. Instead, they are mapped to a system-wide, enumerated integer registry. A bid's targeting vector can then be represented as a bitfield or a compact array of integers, allowing for extremely fast, bitwise matching operations within the state machine.  
* **Order Book Structure:** The persistent buy-side of the UAB is implemented using efficient data structures (e.g., balanced binary trees or skip lists indexed by price level) to allow for O(\\log N) insertion, deletion, and lookup times.

#### **3.2.2 The Asymmetric Matching Algorithm**

The matching logic is executed by every validator as part of the state transition function. It is designed to handle the asymmetric nature of the ad market.

1. **Persistent Bids:** Advertisers submit place\_bid transactions. These bids, containing a price and a vector of targeting attributes, are added to the persistent, on-chain buy-side order book.  
2. **Ephemeral Trigger:** When an ad opportunity occurs, the publisher's system submits a trigger\_auction transaction. This transaction is not stored on the book; it is an instantaneous event containing the user's attribute vector and the publisher's floor price.  
3. **Real-Time Matching:** The AdMatch engine processes the trigger\_auction transaction by: a. Querying the persistent buy-side book to find all resting bids whose targeting attributes are a match for the user's attribute vector. b. From this subset of eligible bids, filtering out any that are below the publisher's floor price. c. Applying **Price-Time Priority**: The highest-priced bid among the remaining candidates is selected. If multiple bids exist at the highest price, the one that was placed on the book first (the oldest) is chosen.  
4. **Atomic Settlement:** The matching of the winning bid and the auction trigger, the creation of the VAI record, and the corresponding debit/credit of the advertiser and publisher/user accounts occur as a single, atomic operation. If any part of the operation fails, the entire transaction is reverted.

This process is transparent, fully deterministic, and auditable. Any party can independently verify the entire history of the exchange by replaying the on-chain transactions against the open-source matching engine logic.

### **3.3 Consensus Protocol: HotStuff-rs Implementation**

The performance of the AdMatch engine is anchored by its consensus mechanism. The protocol utilizes a highly optimized BFT consensus engine based on the HotStuff-rs implementation.  
Unlike classic BFT protocols that operate in discrete rounds, HotStuff and its derivatives are engineered for continuous sequencing of transactions. This design minimizes the protocol overhead between blocks, allowing the network to process a continuous stream of bids and auction triggers without idle time, dramatically improving throughput and reducing latency. The target is a median end-to-end latency of under 200 milliseconds from transaction submission to final confirmation, providing the near-instantaneous feedback required for a real-time bidding environment.  
Furthermore, this consensus model provides one-block finality. Once a transaction (e.g., a matched VAI) is included in a block and consensus is reached, it is irreversible. This property is critical for financial applications, as it eliminates settlement risk and provides absolute certainty to all participants that a completed transaction cannot be undone.

### **3.4 The Transaction Pipeline: From Bid to Verifiable Impression**

The efficiency of the Unwalled L1 extends to the entire lifecycle of a transaction, from the moment a user signs an action to its final settlement.

#### **3.4.1 Cryptographic "AdActions"**

Users interact with the Unwalled L1 by signing structured data messages that represent specific "AdActions," rather than signing full, general-purpose blockchain transactions. This approach is significantly more efficient in terms of both data size and computational cost. An advertiser's client, for example, would construct a message containing the parameters for a place\_bid action, serialize it into a compact binary format (like msgpack), and sign the resulting hash with their DID's private key. This signed message is the atomic unit submitted to the network.

#### **3.4.2 A Semantically-Aware Mempool for Ad Transactions**

As established in Section 1.3, the Unwalled protocol's mempool and block proposal logic are semantically aware of the AdActions it is processing. This enables a deterministic intra-block sorting order that provides powerful execution guarantees. The proposed sorting sequence within every block is:

1. **State Management Actions:** Transactions that do not interact with the UAB, such as fund\_campaign or DID registry updates.  
2. **Cancellation Actions:** All cancel\_bid transactions.  
3. **New Order Actions:** All actions that place new place\_bid orders on the book.  
4. **Auction Triggers:** Finally, all trigger\_auction transactions are processed against the now-settled state of the order book.

Within each category, actions are sorted by the order in which they were received by the block proposer. This strict, protocol-enforced ordering provides cryptographic certainty for participants. An advertiser can cancel a bid and know with certainty that the cancellation will be processed before any new auction triggers in the same block, preventing their bid from being filled unintentionally. This level of deterministic control is a transformative improvement over the probabilistic and often adversarial nature of transaction ordering in general-purpose blockchain mempools.

### **3.5 The Physical Storage Layer: RocksDB**

The performance and integrity of the Unwalled L1 are fundamentally dependent on its physical storage layer. For this critical component, the architecture specifies **RocksDB** as the embedded database engine. This decision is based on a rigorous evaluation of the system's unique requirements for high-throughput, low-latency, and durable state management.  
RocksDB is a high-performance, embeddable, persistent key-value store developed by Facebook and optimized for fast storage environments like SSDs and NVMe drives. Its selection is driven by several key factors that align directly with the Unwalled L1's design goals:

* **Embedded Architecture:** As an embedded database, RocksDB operates as a library within the Unwalled node's process, eliminating the network overhead and latency associated with traditional client-server databases. This is a perfect fit for the self-contained, monolithic design of the node software, ensuring the fastest possible access to state data.  
* **Write-Optimized Performance:** RocksDB is built on a Log-Structured Merge-Tree (LSM-Tree) data structure. This architecture is exceptionally well-suited for the write-intensive workload of the Unwalled exchange, which involves a constant stream of new bids, cancellations, and state updates. The LSM-Tree design absorbs these high-volume writes by buffering them in memory and flushing them to disk sequentially, avoiding the performance bottlenecks of random disk writes.  
* **Durability and Crash Recovery:** All write operations are first committed to a Write-Ahead Log (WAL) before being placed in the in-memory buffer (MemTable). This ensures that in the event of a node crash or power failure, no committed state changes are lost, guaranteeing the durability required for a financial ledger.  
* **Proven in Blockchain Environments:** RocksDB is the battle-tested storage engine for numerous high-performance blockchain clients, such as the Ethereum client Nethermind. Its ability to efficiently manage the complex state data of a blockchain, including Patricia trie nodes, account information, and contract storage, makes it the industry-standard choice for this specific use case.

Within the Unwalled L1, RocksDB will be responsible for persisting the entire canonical state, including the UAB's persistent buy-side order book, the DID registry, campaign treasuries, and all account balances. Its advanced features, such as configurable compaction strategies and block caching, will be tuned to optimize read performance and manage disk space effectively, ensuring the node remains performant as the chain state grows.

## **Section 4: Integration, Settlement, and Data Management**

The Unwalled L1 application chain is the high-performance core of the ecosystem, but it does not exist in isolation. Its architecture includes robust mechanisms for interacting with the broader digital economy, settling value with external systems, managing identity, and ensuring the integrity of every ad impression. This section details the architecture for these critical integration layers.

### **4.1 The Settlement Layer Interface: A Modular Approach to Scalability and Compliance**

The Unwalled L1 is designed for the immense volume of real-time bidding activity, while high-value settlement, identity verification, and compliance functions are handled by a compatible base layer. To ensure flexibility and future-proof the architecture, the Unwalled L1 does not hard-code a dependency on a single settlement layer. Instead, it defines a standardized **Settlement Layer Interface**.  
This interface specifies a set of functions and data structures that any Layer-1 blockchain can implement to become a valid settlement layer for the Unwalled ecosystem. This modular approach allows Unwalled to remain agile, integrating with the most performant, secure, and compliant settlement solutions as they emerge.  
A prime example of a compatible L1 is **Keeta ($KTA)**, whose architecture is optimized for extreme performance and regulatory compliance. Other emergent technologies, such as permissioned environments like **Circle's Perimeter Protocol**, could also integrate by implementing the interface.  
The architecture connecting the Unwalled L1 to a compatible settlement L1 functions as a "rollup-style" bridge:

1. **High-Frequency Micro-transactions on L1:** The Unwalled app-chain processes millions of low-value, real-time AdActions per second—placing bids, matching VAIs, and making micro-adjustments to user and publisher balances within their on-L1 accounts.  
2. **Periodic State Commitments:** On a regular basis (e.g., every few minutes), a special validator on the Unwalled L1 computes a compressed summary of all net financial state changes that have occurred. This summary includes the net debits and credits for all advertiser campaign treasuries, publisher accounts, and user reward pools.  
3. **Settlement on Compatible L1:** This compressed summary, along with a cryptographic proof of its validity (e.g., a Merkle root of all included transactions), is submitted as a single transaction to a smart contract on the settlement network. This transaction finalizes the net settlement, moving large sums of value (e.g., an advertiser depositing $1M in stablecoins, or a publisher withdrawing their weekly earnings) on the high-security base layer.

This hybrid architecture intelligently leverages the strengths of both chains. The Unwalled L1 provides a sovereign, decentralized, and economically tailored environment for its specific, high-contention application. The settlement layer provides a massively scalable and compliance-friendly layer for the less frequent but high-value task of final settlement.

### **4.2 DID Integration and Credentialing**

The technical implementation of the DID-based identity layer uses established open standards to ensure interoperability and a rich ecosystem of tools.

* **DID Methods:** The system supports standard DID methods, such as did:key for simple, self-sovereign device-based identities, and potentially more robust methods like did:ion (anchored to Bitcoin) or did:ethr for entities requiring higher levels of security and recoverability. The user's wallet is responsible for creating and managing these DIDs.  
* **Verifiable Credentials (VCs):** The protocol natively supports the W3C Verifiable Credentials data model. This allows users to selectively disclose attributes about themselves without revealing their full identity. For example, a user could obtain a VC from a trusted third-party issuer that attests "this user is over the age of 21 and resides in Germany." When an ad opportunity arises that requires these attributes, the client-side application can generate a Verifiable Presentation (VP) containing only this specific credential. This VP is submitted to the network as part of the Auction Trigger, allowing for privacy-preserving targeted advertising based on user-consented data.

### **4.3 Proof-of-View: A Verifiable Impression Protocol**

To combat impression fraud and ensure the integrity of the core VAI asset, the protocol must include a robust mechanism for verifying that an ad was actually rendered and viewable to the user. This "Proof-of-View" protocol will involve a multi-step cryptographic handshake initiated after a bid and ask are matched by the AdMatch engine.

1. **Impression Token Generation:** Upon a successful match on the Unwalled L1, the state transition function generates a unique, single-use "impression token" (e.g., a nonce or a hash of the match details). This token is passed to the publisher's client-side SDK.  
2. **Client-Side Attestation:** The SDK, running in the user's browser or mobile application, is responsible for rendering the ad creative. To generate a proof, it must perform a client-side attestation. This could range from a simple proof-of-work that is computationally trivial for a real device but costly for a bot at scale, to more advanced methods like receiving a signed attestation from a trusted hardware element (e.g., Apple's Private Access Tokens or Android's Play Integrity API) if available. The attestation must incorporate the unique impression token to prevent replay attacks.  
3. **Co-Signing Ceremony:** The generated proof, along with the impression token, is then co-signed by both the user's DID and the publisher's DID. The user's signature attests to their presence and consent, while the publisher's signature attests that the ad was served in the correct slot.  
4. **Proof Submission and Settlement:** This final, co-signed "Proof-of-View" artifact is submitted as a transaction back to the Unwalled L1. A dedicated module within the state machine verifies the signatures and the validity of the proof. Upon successful verification, this transaction triggers the final, atomic settlement of funds: the advertiser's campaign treasury is debited, and the corresponding amounts are credited directly to the publisher's and the user's wallets according to the terms of the VAI.

This protocol creates a closed-loop, cryptographically secure audit trail for every single impression, making fraud exceptionally difficult and economically unviable.

## **Section 5: Implementation Strategy and Scalability Roadmap**

The architectural blueprint detailed in the preceding sections provides the "what" and the "why." This final section provides the "how"—an actionable strategy for building, launching, and scaling the Unwalled network.

### **5.1 Technology Stack**

The choice of technology is critical for achieving the performance and security goals of the Unwalled L1.

* **Protocol Implementation:** The core node software, including the consensus and the AdMatch state machine, is implemented in **Rust**. Rust's focus on performance (zero-cost abstractions, fine-grained memory control) and safety (compile-time guarantees against memory and concurrency bugs) makes it the industry standard for building high-stakes blockchain protocols. The consensus engine is built using the **HotStuff-rs** framework, providing a robust and performant BFT implementation.  
* **Client-Side SDKs:** To foster rapid adoption, the project provides official, well-documented Software Development Kits (SDKs) for all key stakeholders. This includes:  
  * **TypeScript/JavaScript:** For integration into web-based publisher sites and advertiser dashboards.  
  * **Swift (iOS) & Kotlin (Android):** For native mobile application integration by publishers.  
  * **Python & Go:** For advertisers' and publishers' backend systems to programmatically manage campaigns, analyze data, and interact with the network.

### **5.2 Phased Network Rollout**

A complex system like the Unwalled network is launched in carefully managed phases to ensure stability, security, and community buy-in.

* **Phase 1: Incentivized Testnet:** The initial launch will be a public testnet with a simulated UAB and faucet-supplied tokens. This phase is crucial for attracting an initial community of developers, advertisers, and publishers. A structured incentive program rewards participants for stress-testing the network, identifying bugs, building initial tooling, and providing feedback on the protocol's economic parameters.  
* **Phase 2: Guarded Mainnet:** The first mainnet launch is "guarded," operating with a limited, permissioned set of validator nodes run by the core development team and trusted partners. This allows the network to operate with real value while providing a controlled environment to monitor performance, respond to incidents, and deploy upgrades rapidly. Early-adopter advertisers and publishers are onboarded during this phase.  
* **Phase 3: Permissionless Mainnet:** Once the network has demonstrated a prolonged period of stability and the governance mechanisms are mature, validator participation is opened to the public. The network transitions to a fully decentralized, permissionless Proof-of-Stake (PoS) model, where any entity can run a validator node by staking the native network token, thus achieving full censorship resistance and decentralization.

### **5.3 Performance Bottlenecks and Future Optimizations**

As the Unwalled network grows to internet scale, it will inevitably encounter performance bottlenecks. Proactive planning for these challenges is essential. The primary long-term performance bottleneck will not be consensus or networking but **state execution**—the raw computational cost of running the AdMatch engine on a single thread across millions of bids and auction triggers.  
The long-term scalability roadmap must therefore focus on optimizing and parallelizing state execution. Potential avenues for future research and development include:

* **State Execution Sharding:** While a single, unified CLOB is difficult to parallelize due to its highly contentious state, it may be possible to shard the UAB across independent ad markets. For example, the order books for different geographic regions (e.g., North America vs. Asia) or different vertical categories (e.g., automotive vs. fashion) could potentially be processed in parallel by different subsets of validators, significantly increasing overall throughput.  
* **Hardware Acceleration:** The deterministic and computationally-intensive nature of the matching algorithm makes it a prime candidate for hardware acceleration. The AdMatch logic could be designed to be offloaded to Field-Programmable Gate Arrays (FPGAs) or other specialized hardware within validator nodes, yielding orders-of-magnitude performance improvements over CPU-based execution.  
* **Networking Layer Improvements:** As throughput increases, the size of blocks containing AdActions will grow. To ensure these blocks can be propagated across the global validator network with low latency, the protocol will eventually need to upgrade its block propagation mechanism, potentially implementing a protocol similar to Solana's Turbine, which breaks blocks into smaller packets and disseminates them through a hierarchical tree structure.

## **Conclusion**

The architecture detailed in this document presents a clear and actionable path toward realizing the Unwalled vision. It is an architecture born from a rigorous analysis of what works in the most demanding corners of the decentralized technology landscape. By rejecting the one-size-fits-all model of general-purpose blockchains and instead embracing the application-specific imperative, Unwalled can achieve a level of performance, efficiency, and fairness that is unattainable with existing ad-tech infrastructure.  
The proposed system uniquely leverages the proven patterns of high-frequency trading—the in-consensus CLOB, semantic awareness, and vertical integration—to solve the core problems of real-time bidding. This approach transforms the ad auction from an opaque, intermediary-controlled process into a transparent, protocol-governed marketplace. The foundation of Decentralized Identity creates a cryptographically verifiable supply chain, restoring trust and providing a powerful defense against fraud and bot traffic.  
The architecture makes deliberate, informed trade-offs. The choice of a modular, interface-driven settlement model is a pragmatic acknowledgment that different system components have different requirements for decentralization and scalability. It combines a sovereign, performant app-chain for the core application with a hyper-scalable, compliance-oriented rail for final settlement, achieving the best of both worlds.  
Ultimately, the Unwalled protocol is more than a technological proposal; it is an economic one. By building on a foundation of strong identity, radical transparency, and fair, open-market principles, it can create a hyper-efficient ad-tech ecosystem that fundamentally realigns the economic incentives of the open internet. It creates a new paradigm where users are compensated for their attention, publishers are rewarded fairly for their inventory, and advertisers can be certain their capital is being deployed effectively against verifiably human engagement. This is the blueprint for dismantling the walled gardens and building a more equitable and efficient foundation for the future of digital advertising.

#### **Works cited**

1\. Unwalled Manifesto, https://unwalled.net 2\. "unwalled": Not enclosed or protected by walls \- OneLook, https://www.onelook.com/?loc=dmapirel\&w=unwalled 3\. UNWALLED definition in American English \- Collins Dictionary, https://www.collinsdictionary.com/us/dictionary/english/unwalled 4\. Unwalled Definition & Meaning | YourDictionary, https://www.yourdictionary.com/unwalled 5\. Unwalled.Garden: souped-up RSS for P2P social apps, https://pfrazee.github.io/blog/unwalled-garden 6\. Ezekiel 38:11 You will say, 'I will go up against a land of unwalled villages; I will come against a tranquil people who dwell securely, all of them living without walls or bars or gates-- \- Bible Hub, https://biblehub.com/ezekiel/38-11.htm 7\. RocksDB | A persistent key-value store | RocksDB, https://rocksdb.org/ 8\. RocksDB for Low-Latency Operations \- Simplyblock, https://www.simplyblock.io/glossary/what-is-rocksdb/ 9\. RocksDB: Your Key-Value Store Powerhouse (and Why You Should Care), https://dev.to/ashokan/rocksdb-your-key-value-store-powerhouse-and-why-you-should-care-3880 10\. Architectural Underpinnings of Blockchain Data Storage: A Technical Analysis of LevelDB and RocksDB in Node Clients | by Deeptanshu Sankhwar | Medium, https://medium.com/@deeptanshu.sankhwar/architectural-underpinnings-of-blockchain-data-storage-a-technical-analysis-of-leveldb-and-rocksdb-b8db271e5795 11\. Database | Nethermind documentation, https://docs.nethermind.io/fundamentals/database/ 12\. Walled Unwalled | Cinematheque Beirut, https://www.cinemathequebeirut.com/cinematheque/film/2039